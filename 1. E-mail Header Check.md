# Email Header Analysis - 

## Sample Phishing Email - 

<img width="1813" height="762" alt="Image" src="https://github.com/user-attachments/assets/6f14aded-3d7f-4767-9dca-69ec78cd14c5" />

## Original Message -

<img width="1573" height="560" alt="Original Message" src="https://github.com/user-attachments/assets/c334296c-64f1-4bcc-b08f-70ddb3a6b61f" />


## Header Analysis - 

<img width="1573" height="560" alt="Original Message" src="https://github.com/user-attachments/assets/087d7964-a12a-443e-9cba-5e7da69341ae" />


# Checking Sender IP

**Virustotal -**

<img width="1895" height="919" alt="IP Checking" src="https://github.com/user-attachments/assets/d23d4b9e-c9c1-4f2a-989e-24fff9e8f08d" />

**Mxtoolbox**

<img width="1902" height="885" alt="Ip Black Listing" src="https://github.com/user-attachments/assets/efb81baf-403e-4c71-a79f-23b3b6e99238" />

**whois**

<img width="1253" height="898" alt="whois" src="https://github.com/user-attachments/assets/a4ef78c9-9499-4c54-bc16-94f6dbc2ed1c" />

# Checking Authentication Protocol SPF, DKIM And DMARC -

<img width="1882" height="645" alt="Mxtoolbox" src="https://github.com/user-attachments/assets/f58263e4-a21a-43d9-a781-3315b67e532b" />

# Why Gmail Authentication Results Differ from MXToolbox Results

* During analysis, Gmail showed that the email passed SPF, DKIM, and DMARC, while MXToolbox reported a DKIM failure for the same domain.
* This difference occurs because Gmail validates authentication for the actual email message, while MXToolbox validates the public DNS configuration, which may not represent the record used for the specific message.

# Key reasons for the difference:

## DKIM Selector Mismatch:
* The email may use a valid DKIM selector (e.g., selector1), while MXToolbox checks another selector or assumes a default value.

## Multiple Sending Providers:
* The domain may use multiple services (O365, CRM tools, website contact forms) with different DKIM/SPF configurations.
* Gmail validated the correct service, while MXToolbox read a different DNS record.

## DNS Misconfiguration:
* The domain may have outdated or incomplete authentication records in DNS, causing MXToolbox checks to fail even though the specific message was signed correctly.

## Message-Level vs Domain-Level Check:
* Gmail analyzes the DKIM signature embedded in the received email.
* MXToolbox analyzes the domain’s DNS configuration, not the same DKIM signature.

## Because of this, it is possible for:

* Gmail → DKIM = PASS
* MXToolbox → DKIM = FAIL
* for the same domain.

* This is normal in cases where domains use multiple email services or have partially misconfigured DNS records.




